<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#3498db" />
    <meta
      name="description"
      content="Flashcards Seznam - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —á–µ—à—Å–∫–∏—Ö —Å–ª–æ–≤ —Å –ø–æ–º–æ—â—å—é –∫–∞—Ä—Ç–æ—á–µ–∫"
    />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link rel="manifest" href="/manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <title>Flashcards Seznam</title>
    
    <style>
      /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ CSS */
      :root {
        --primary-color: #2c3e50;
        --secondary-color: #3498db;
        --accent-color: #e74c3c;
        --light-color: #ecf0f1;
        --dark-color: #34495e;
        --success-color: #27ae60;
        --warning-color: #f39c12;
        --border-radius: 8px;
        --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        --transition: all 0.3s ease;
      }
      
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      
      body {
        font-family: 'Roboto', 'Segoe UI', sans-serif;
        line-height: 1.6;
        color: var(--dark-color);
        background-color: var(--light-color);
      }
      
      .app {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      
      .header {
        text-align: center;
        margin-bottom: 40px;
        padding: 20px;
        border-bottom: 2px solid var(--secondary-color);
      }
      
      .header h1 {
        color: var(--primary-color);
        font-size: 2.5rem;
        margin-bottom: 10px;
      }
      
      .subtitle {
        color: var(--dark-color);
        font-size: 1.2rem;
        font-weight: 300;
      }
      
      .main-content {
        background-color: white;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        padding: 30px;
        min-height: 500px;
      }
      
      .btn {
        display: inline-block;
        padding: 10px 20px;
        border: none;
        border-radius: var(--border-radius);
        cursor: pointer;
        font-size: 1rem;
        font-weight: 500;
        text-align: center;
        transition: var(--transition);
      }
      
      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }
      
      .btn-primary {
        background-color: var(--secondary-color);
        color: white;
      }
      
      .btn-primary:hover:not(:disabled) {
        background-color: #2980b9;
      }
      
      .btn-secondary {
        background-color: var(--light-color);
        color: var(--dark-color);
        border: 1px solid var(--dark-color);
      }
      
      .btn-secondary:hover:not(:disabled) {
        background-color: #dfe6e9;
      }
      
      .actions {
        margin-top: 20px;
        display: flex;
        gap: 10px;
        justify-content: center;
      }
      
      .extracted-words {
        margin-bottom: 30px;
      }
      
      .extracted-words h2 {
        margin-bottom: 20px;
        text-align: center;
        color: var(--primary-color);
      }
      
      .words-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 30px;
      }
      
      .word-chip {
        background-color: var(--light-color);
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 0.9rem;
        border: 1px solid #bdc3c7;
        color: var(--dark-color);
        transition: var(--transition);
      }
      
      .word-chip:hover {
        background-color: var(--secondary-color);
        color: white;
        border-color: var(--secondary-color);
      }
      
      /* –°—Ç–∏–ª–∏ –¥–ª—è TextInput */
      .text-input {
        width: 100%;
        max-width: 800px;
        margin: 0 auto;
      }
      
      .text-input h2 {
        text-align: center;
        margin-bottom: 15px;
        color: var(--primary-color);
      }
      
      .instruction {
        text-align: center;
        margin-bottom: 20px;
        color: var(--dark-color);
        font-size: 1rem;
      }
      
      .text-area {
        width: 100%;
        min-height: 200px;
        padding: 15px;
        border-radius: var(--border-radius);
        border: 1px solid #bdc3c7;
        font-family: inherit;
        font-size: 1rem;
        resize: vertical;
        transition: var(--transition);
        margin-bottom: 20px;
      }
      
      .text-area:focus {
        outline: none;
        border-color: var(--secondary-color);
        box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
      }
      
      .text-input .btn {
        display: block;
        margin: 0 auto;
        min-width: 200px;
      }
      
      /* –°—Ç–∏–ª–∏ –¥–ª—è FlashcardViewer */
      .flashcard-viewer {
        width: 100%;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px 0;
      }
      
      .progress-info {
        text-align: center;
        margin-bottom: 20px;
        font-size: 1.1rem;
        color: var(--dark-color);
      }
      
      .card-container {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 20px;
        margin-bottom: 30px;
        min-height: 350px;
      }
      
      .nav-btn {
        background: var(--light-color);
        border: none;
        color: var(--primary-color);
        font-size: 2rem;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: var(--transition);
        box-shadow: var(--shadow);
      }
      
      .nav-btn:hover {
        background-color: var(--secondary-color);
        color: white;
      }
      
      .nav-btn:focus {
        outline: none;
      }
      
      .card-progress {
        display: flex;
        justify-content: center;
        gap: 8px;
        margin-top: 20px;
      }
      
      .progress-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background-color: var(--light-color);
        border: 1px solid var(--dark-color);
        cursor: pointer;
        transition: var(--transition);
      }
      
      .progress-dot.active {
        background-color: var(--secondary-color);
        border-color: var(--secondary-color);
        transform: scale(1.2);
      }
      
      .no-cards {
        text-align: center;
        padding: 50px 0;
        font-size: 1.2rem;
        color: var(--dark-color);
      }
      
      /* –°—Ç–∏–ª–∏ –¥–ª—è Flashcard */
      .flashcard {
        width: 100%;
        max-width: 400px;
        height: 300px;
        perspective: 1000px;
        cursor: pointer;
      }
      
      .card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        transition: transform 0.6s;
        transform-style: preserve-3d;
        box-shadow: var(--shadow);
        border-radius: var(--border-radius);
      }
      
      .flashcard.flipped .card-inner {
        transform: rotateY(180deg);
      }
      
      .card-front, .card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 20px;
        border-radius: var(--border-radius);
      }
      
      .card-front {
        background-color: var(--secondary-color);
        color: white;
      }
      
      .card-back {
        background-color: white;
        color: var(--dark-color);
        transform: rotateY(180deg);
        overflow-y: auto;
        align-items: flex-start;
        justify-content: flex-start;
      }
      
      .word {
        font-size: 2.5rem;
        margin-bottom: 20px;
        text-align: center;
        font-weight: 700;
      }
      
      .hint {
        font-size: 0.9rem;
        opacity: 0.8;
        position: absolute;
        bottom: 15px;
        text-align: center;
        font-style: italic;
      }
      
      .original-word {
        font-size: 1.8rem;
        margin-bottom: 15px;
        color: var(--primary-color);
        text-align: center;
        width: 100%;
      }
      
      .translations, .examples {
        width: 100%;
        margin-bottom: 15px;
      }
      
      .translations h4, .examples h4 {
        font-size: 1.1rem;
        margin-bottom: 8px;
        color: var(--primary-color);
        border-bottom: 1px solid var(--light-color);
        padding-bottom: 5px;
      }
      
      .translations ul, .examples ul {
        list-style-type: none;
      }
      
      .translations li {
        margin-bottom: 8px;
        font-size: 1.1rem;
      }
      
      .examples li {
        margin-bottom: 15px;
        background-color: var(--light-color);
        padding: 10px;
        border-radius: var(--border-radius);
      }
      
      .sample-phrase {
        font-weight: 500;
        margin-bottom: 5px;
        color: var(--primary-color);
      }
      
      .sample-translation {
        font-style: italic;
      }
      
      .note {
        font-size: 0.9rem;
        font-style: italic;
        color: var(--dark-color);
        margin-top: 10px;
        text-align: center;
      }
      
      .attribution {
        font-size: 0.8rem;
        color: #999;
        position: absolute;
        bottom: 5px;
        right: 10px;
      }
      
      .api-attribution {
        text-align: center;
        margin-top: 20px;
        font-size: 0.9rem;
        color: #999;
      }
      
      /* –°—Ç–∏–ª–∏ –¥–ª—è –±–ª–æ–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ */
      .normalization-info {
        background-color: #e3f2fd;
        padding: 8px 12px;
        border-radius: 6px;
        margin-bottom: 15px;
        border: 1px solid #bbdefb;
        font-size: 0.85rem;
        width: 100%;
      }
      
      .normalization-hint {
        font-size: 0.8rem;
        opacity: 0.8;
        margin-top: 10px;
        font-style: italic;
        color: #f0f0f0;
      }
      
      /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
      .progress-container {
        margin: 20px auto;
        max-width: 400px;
      }
      
      .progress-bar {
        height: 10px;
        background-color: #ecf0f1;
        border-radius: 5px;
        overflow: hidden;
        margin-bottom: 5px;
      }
      
      .progress-bar-fill {
        height: 100%;
        background-color: var(--secondary-color);
        border-radius: 5px;
        transition: width 0.3s ease;
      }
      
      .progress-text {
        font-size: 14px;
        color: #7f8c8d;
        text-align: center;
      }
      
      /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö */
      .error-message {
        color: var(--accent-color);
        text-align: center;
        margin: 15px 0;
        padding: 10px;
        border: 1px solid var(--accent-color);
        border-radius: var(--border-radius);
        background-color: rgba(231, 76, 60, 0.1);
      }
      
      /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤–∞—Ä–µ–º */
      .dictionary-stats {
        margin-top: 30px;
        padding: 15px;
        background-color: #f8f9fa;
        border-radius: var(--border-radius);
        text-align: center;
      }
      
      .dictionary-button {
        margin-left: 10px;
        padding: 8px 15px;
        background-color: var(--secondary-color);
        color: white;
        border: none;
        border-radius: var(--border-radius);
        cursor: pointer;
        font-size: 0.9rem;
      }
      
      .dictionary-view {
        margin-top: 20px;
        max-height: 300px;
        overflow-y: auto;
        border: 1px solid #ddd;
        border-radius: var(--border-radius);
        padding: 15px;
      }
      
      .dict-word-item {
        margin-bottom: 10px;
        padding-bottom: 10px;
        border-bottom: 1px solid #eee;
      }
      
      .dict-word {
        font-weight: 500;
        color: var(--primary-color);
      }
      
      .dict-translations {
        margin-left: 15px;
        font-size: 0.9rem;
      }
      
      /* –ó–∞–≥—Ä—É–∑–æ—á–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä */
      .loading {
        text-align: center;
        padding: 20px;
        color: var(--dark-color);
      }
      
      /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
      @media screen and (max-width: 768px) {
        .app {
          padding: 10px;
        }
        
        .header h1 {
          font-size: 2rem;
        }
        
        .main-content {
          padding: 20px;
        }
        
        .words-container {
          justify-content: center;
        }
        
        .text-area {
          min-height: 150px;
        }
        
        .card-container {
          flex-direction: column;
          gap: 15px;
        }
        
        .nav-btn {
          order: 1;
          width: 40px;
          height: 40px;
          font-size: 1.5rem;
        }
        
        .card-progress {
          max-width: 100%;
          flex-wrap: wrap;
        }
        
        .normalization-info {
          padding: 6px 10px;
          font-size: 0.8rem;
        }
      }
    </style>
  </head>
  <body>
    <noscript>–î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∫–ª—é—á–∏—Ç—å JavaScript.</noscript>
    <div id="root">
      <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...</div>
    </div>
    
    <!-- React –∏–∑ CDN –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Firebase SDK v9 -->
    <script type="module">
      // –ò–º–ø–æ—Ä—Ç Firebase SDK –∏–∑ CDN  
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js';
      import { getDatabase, ref, set, get } from 'https://www.gstatic.com/firebasejs/10.8.1/firebase-database.js';
      
      // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–ï–ó ANALYTICS
      const firebaseConfig = {
        apiKey: "AIzaSyAPZIHxaLt92McIvbIcYE-tSYp2Li2jxs4",
        authDomain: "flashcards-seznam-6652a.firebaseapp.com",
        projectId: "flashcards-seznam-6652a", 
        storageBucket: "flashcards-seznam-6652a.firebasestorage.app",
        messagingSenderId: "99460986155",
        appId: "1:99460986155:web:e5ca466e3d07c20cde016e",
        // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ë–ï–ó —Å–ª—ç—à–∞ –≤ –∫–æ–Ω—Ü–µ
        databaseURL: "https://flashcards-seznam-6652a-default-rtdb.europe-west1.firebasedatabase.app"
      };
      
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Firebase
      let app, database;
      
      try {
        console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase...');
        app = initializeApp(firebaseConfig);
        database = getDatabase(app);
        
        console.log('Firebase —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        
        // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ë–ï–ó .info/connected 
        const testRef = ref(database, 'test');
        get(testRef).then(() => {
          console.log('–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å Firebase Database —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
        }).catch((error) => {
          console.warn('–ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º Firebase Database:', error);
        });
        
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase:', error);
        // –°–æ–∑–¥–∞–µ–º –∑–∞–≥–ª—É—à–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ offline —Ä–µ–∂–∏–º–µ
        database = null;
      }
      
      // –î–µ–ª–∞–µ–º Firebase –¥–æ—Å—Ç—É–ø–Ω—ã–º –≥–ª–æ–±–∞–ª—å–Ω–æ
      window.firebaseApp = app;
      window.firebaseDB = database;
      window.firebaseRef = ref;
      window.firebaseSet = set;
      window.firebaseGet = get;
    </script>
    
    <!-- üî• –£–õ–£–ß–®–ï–ù–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–ò –ß–ï–®–°–ö–ò–• –°–õ–û–í -->
    <script>
      // –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —á–µ—à—Å–∫–∏—Ö —Å–ª–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏
      class CzechNormalizer {
        constructor() {
          // –°–ª–æ–≤–∞—Ä—å –∏—Å–∫–ª—é—á–µ–Ω–∏–π - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—ã
          this.exceptions = {
            // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã
            'jsem': 'b√Ωt', 'jsi': 'b√Ωt', 'je': 'b√Ωt', 'jsme': 'b√Ωt', 'jste': 'b√Ωt', 'jsou': 'b√Ωt',
            'byl': 'b√Ωt', 'byla': 'b√Ωt', 'bylo': 'b√Ωt', 'byli': 'b√Ωt', 'byly': 'b√Ωt',
            'm√°m': 'm√≠t', 'm√°≈°': 'm√≠t', 'm√°': 'm√≠t', 'm√°me': 'm√≠t', 'm√°te': 'm√≠t', 'maj√≠': 'm√≠t',
            'mƒõl': 'm√≠t', 'mƒõla': 'm√≠t', 'mƒõli': 'm√≠t', 'mƒõly': 'm√≠t',
            'jdu': 'j√≠t', 'jde≈°': 'j√≠t', 'jde': 'j√≠t', 'jdeme': 'j√≠t', 'jdete': 'j√≠t', 'jdou': 'j√≠t',
            '≈°el': 'j√≠t', '≈°la': 'j√≠t', '≈°li': 'j√≠t', '≈°ly': 'j√≠t',
            'v√≠m': 'vƒõdƒõt', 'v√≠≈°': 'vƒõdƒõt', 'v√≠': 'vƒõdƒõt', 'v√≠me': 'vƒõdƒõt', 'v√≠te': 'vƒõdƒõt', 'vƒõd√≠': 'vƒõdƒõt',
            'vƒõdƒõl': 'vƒõdƒõt', 'vƒõdƒõla': 'vƒõdƒõt',
            
            // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ
            'lid√©': 'ƒçlovƒõk', 'lid√≠': 'ƒçlovƒõk', 'lidem': 'ƒçlovƒõk', 'lidi': 'ƒçlovƒõk', 'lidech': 'ƒçlovƒõk', 'lidmi': 'ƒçlovƒõk',
            'dƒõti': 'd√≠tƒõ', 'dƒõt√≠': 'd√≠tƒõ', 'dƒõtem': 'd√≠tƒõ', 'dƒõtmi': 'd√≠tƒõ', 'dƒõtech': 'd√≠tƒõ',
            'oƒçi': 'oko', 'oƒç√≠': 'oko', 'oƒç√≠m': 'oko', 'oƒçima': 'oko', 'oƒç√≠ch': 'oko',
            'u≈°i': 'ucho', 'u≈°√≠': 'ucho', 'u≈°√≠m': 'ucho', 'u≈°ima': 'ucho', 'u≈°√≠ch': 'ucho',
            
            // –°—Ç–µ–ø–µ–Ω–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            'lep≈°√≠': 'dobr√Ω', 'nejlep≈°√≠': 'dobr√Ω',
            'hor≈°√≠': '≈°patn√Ω', 'nejhor≈°√≠': '≈°patn√Ω',
            'vƒõt≈°√≠': 'velk√Ω', 'nejvƒõt≈°√≠': 'velk√Ω',
            'men≈°√≠': 'mal√Ω', 'nejmen≈°√≠': 'mal√Ω',
            'star≈°√≠': 'star√Ω', 'nejstar≈°√≠': 'star√Ω',
            'mlad≈°√≠': 'mlad√Ω', 'nejmlad≈°√≠': 'mlad√Ω',
            
            // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—ã –∏–∑ –≤–∞—à–µ–≥–æ —Ç–µ–∫—Å—Ç–∞
            'kladen√Ωch': 'kl√°st',
            'z√°kaznickou': 'z√°kazn√≠k',
            'smƒõ≈ôujte': 'smƒõ≈ôovat',
            'pros√≠me': 'prosit',
            'nahl√©dnout': 'nahl√©dnout',
            'zlep≈°en√≠': 'zlep≈°it'
          };
          
          // –£–õ–£–ß–®–ï–ù–ù–´–ï –ø—Ä–∞–≤–∏–ª–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ - –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –í–°–ï –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
          this.normalizationRules = [
            // –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –≥–ª–∞–≥–æ–ª—å–Ω—ã–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è (–Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–π –ò —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–π –≤–∏–¥)
            { 
              pattern: /ujeme$/, 
              replacements: ['ovat', 'it'], 
              type: 'verb' 
            }, // doporuƒçujeme ‚Üí doporuƒçovat –ò doporuƒçit
            { 
              pattern: /ujete$/, 
              replacements: ['ovat', 'it'], 
              type: 'verb' 
            }, // doporuƒçujete ‚Üí doporuƒçovat –ò doporuƒçit
            { 
              pattern: /uj√≠$/, 
              replacements: ['ovat', 'it'], 
              type: 'verb' 
            }, // doporuƒçuj√≠ ‚Üí doporuƒçovat –ò doporuƒçit
            { 
              pattern: /uji$/, 
              replacements: ['ovat', 'it'], 
              type: 'verb' 
            }, // doporuƒçuji ‚Üí doporuƒçovat –ò doporuƒçit
            { 
              pattern: /uje≈°$/, 
              replacements: ['ovat', 'it'], 
              type: 'verb' 
            }, // doporuƒçuje≈° ‚Üí doporuƒçovat –ò doporuƒçit
            
            // –û–±—â–∏–µ –≥–ª–∞–≥–æ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
            { pattern: /eme$/, replacements: ['at'], type: 'verb' },          // dƒõl√°me ‚Üí dƒõlat
            { pattern: /ete$/, replacements: ['at'], type: 'verb' },          // dƒõl√°te ‚Üí dƒõlat
            { pattern: /aj√≠$/, replacements: ['at'], type: 'verb' },          // dƒõlaj√≠ ‚Üí dƒõlat
            { pattern: /√°m$/, replacements: ['at'], type: 'verb' },           // dƒõl√°m ‚Üí dƒõlat
            { pattern: /√°≈°$/, replacements: ['at'], type: 'verb' },           // dƒõl√°≈° ‚Üí dƒõlat
            { pattern: /√°$/, replacements: ['at'], type: 'verb' },            // dƒõl√° ‚Üí dƒõlat
            { pattern: /√≠me$/, replacements: ['it'], type: 'verb' },          // pros√≠me ‚Üí prosit
            { pattern: /√≠te$/, replacements: ['it'], type: 'verb' },          // pros√≠te ‚Üí prosit
            { pattern: /√≠$/, replacements: ['it'], type: 'verb' },            // pros√≠ ‚Üí prosit
            { pattern: /√≠m$/, replacements: ['it'], type: 'verb' },           // pros√≠m ‚Üí prosit
            { pattern: /√≠≈°$/, replacements: ['it'], type: 'verb' },           // pros√≠≈° ‚Üí prosit
            
            // –ü—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è
            { pattern: /oval$/, replacements: ['ovat'], type: 'verb' },       // doporuƒçoval ‚Üí doporuƒçovat
            { pattern: /ovala$/, replacements: ['ovat'], type: 'verb' },      // doporuƒçovala ‚Üí doporuƒçovat
            { pattern: /ovali$/, replacements: ['ovat'], type: 'verb' },      // doporuƒçovali ‚Üí doporuƒçovat
            { pattern: /ovaly$/, replacements: ['ovat'], type: 'verb' },      // doporuƒçovaly ‚Üí doporuƒçovat
            { pattern: /al$/, replacements: ['at'], type: 'verb' },           // dƒõlal ‚Üí dƒõlat
            { pattern: /ala$/, replacements: ['at'], type: 'verb' },          // dƒõlala ‚Üí dƒõlat
            { pattern: /ali$/, replacements: ['at'], type: 'verb' },          // dƒõlali ‚Üí dƒõlat
            { pattern: /aly$/, replacements: ['at'], type: 'verb' },          // dƒõlaly ‚Üí dƒõlat
            { pattern: /el$/, replacements: ['ƒõt'], type: 'verb' },           // vidƒõl ‚Üí vidƒõt
            { pattern: /ƒõla$/, replacements: ['ƒõt'], type: 'verb' },          // vidƒõla ‚Üí vidƒõt
            { pattern: /ƒõli$/, replacements: ['ƒõt'], type: 'verb' },          // vidƒõli ‚Üí vidƒõt
            { pattern: /ƒõly$/, replacements: ['ƒõt'], type: 'verb' },          // vidƒõly ‚Üí vidƒõt
            { pattern: /il$/, replacements: ['it'], type: 'verb' },           // prosil ‚Üí prosit
            { pattern: /ila$/, replacements: ['it'], type: 'verb' },          // prosila ‚Üí prosit
            { pattern: /ili$/, replacements: ['it'], type: 'verb' },          // prosili ‚Üí prosit
            { pattern: /ily$/, replacements: ['it'], type: 'verb' },          // prosily ‚Üí prosit
            
            // –ü–æ–≤–µ–ª–∏—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–∫–ª–æ–Ω–µ–Ω–∏–µ
            { pattern: /ej$/, replacements: ['at'], type: 'verb' },           // dƒõlej ‚Üí dƒõlat
            { pattern: /ejte$/, replacements: ['at'], type: 'verb' },         // dƒõlejte ‚Üí dƒõlat
            { pattern: /ujte$/, replacements: ['it', 'ovat'], type: 'verb' }, // smƒõ≈ôujte ‚Üí smƒõ≈ôit –ò smƒõ≈ôovat
            
            // –ü—Ä–∏—á–∞—Å—Ç–∏—è –∏ –¥–µ–µ–ø—Ä–∏—á–∞—Å—Ç–∏—è
            { pattern: /uj√≠c√≠$/, replacements: ['it', 'ovat'], type: 'verb' }, // doporuƒçuj√≠c√≠ ‚Üí doporuƒçit –ò doporuƒçovat
            { pattern: /aj√≠c√≠$/, replacements: ['at'], type: 'verb' },         // dƒõlaj√≠c√≠ ‚Üí dƒõlat
            { pattern: /en√Ω$/, replacements: ['it'], type: 'verb' },           // doporuƒçen√Ω ‚Üí doporuƒçit
            { pattern: /an√Ω$/, replacements: ['at'], type: 'verb' },           // dƒõlan√Ω ‚Üí dƒõlat
            
            // –ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ - –º—É–∂—Å–∫–æ–π —Ä–æ–¥
            { pattern: /√©ho$/, replacements: ['√Ω'], type: 'adj' },            // dobr√©ho ‚Üí dobr√Ω
            { pattern: /√©mu$/, replacements: ['√Ω'], type: 'adj' },            // dobr√©mu ‚Üí dobr√Ω
            { pattern: /√Ωm$/, replacements: ['√Ω'], type: 'adj' },             // dobr√Ωm ‚Üí dobr√Ω
            { pattern: /√Ωch$/, replacements: ['√Ω'], type: 'adj' },            // kladen√Ωch ‚Üí kladen√Ω
            { pattern: /√Ωmi$/, replacements: ['√Ω'], type: 'adj' },            // dobr√Ωmi ‚Üí dobr√Ω
            { pattern: /√≠ho$/, replacements: ['√≠'], type: 'adj' },            // ciz√≠ho ‚Üí ciz√≠
            { pattern: /√≠mu$/, replacements: ['√≠'], type: 'adj' },            // ciz√≠mu ‚Üí ciz√≠
            { pattern: /√≠m$/, replacements: ['√≠'], type: 'adj' },             // ciz√≠m ‚Üí ciz√≠
            { pattern: /√≠ch$/, replacements: ['√≠'], type: 'adj' },            // ciz√≠ch ‚Üí ciz√≠
            { pattern: /√≠mi$/, replacements: ['√≠'], type: 'adj' },            // ciz√≠mi ‚Üí ciz√≠
            
            // –ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ - –∂–µ–Ω—Å–∫–∏–π —Ä–æ–¥
            { pattern: /ou$/, replacements: ['√°'], type: 'adj' },             // dobrou ‚Üí dobr√°
            { pattern: /ickou$/, replacements: ['ick√Ω'], type: 'adj' },       // z√°kaznickou ‚Üí z√°kaznick√Ω
            
            // –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ - –º—É–∂—Å–∫–æ–π —Ä–æ–¥ —Ç–≤–µ—Ä–¥—ã–π
            { pattern: /ov√©$/, replacements: [''], type: 'noun' },            // mu≈æov√© ‚Üí mu≈æ
            { pattern: /≈Ø$/, replacements: [''], type: 'noun' },              // dotaz≈Ø ‚Üí dotaz, mu≈æ≈Ø ‚Üí mu≈æ
            { pattern: /em$/, replacements: [''], type: 'noun' },             // mu≈æem ‚Üí mu≈æ
            { pattern: /ech$/, replacements: [''], type: 'noun' },            // mu≈æ√≠ch ‚Üí mu≈æ
            { pattern: /√≠ch$/, replacements: [''], type: 'noun' },            // uƒçitel√≠ch ‚Üí uƒçitel
            { pattern: /i$/, replacements: [''], type: 'noun' },              // mu≈æi ‚Üí mu≈æ
            { pattern: /y$/, replacements: [''], type: 'noun' },              // mu≈æi ‚Üí mu≈æ
            
            // –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ - –∂–µ–Ω—Å–∫–∏–π —Ä–æ–¥
            { pattern: /√°ch$/, replacements: ['a'], type: 'noun' },           // ≈æen√°ch ‚Üí ≈æena
            { pattern: /ami$/, replacements: ['a'], type: 'noun' },           // ≈æenami ‚Üí ≈æena
            { pattern: /ƒõ$/, replacements: ['a'], type: 'noun' },             // ≈æenƒõ ‚Üí ≈æena
            { pattern: /u$/, replacements: ['a'], type: 'noun' },             // ≈æenu ‚Üí ≈æena
            { pattern: /y$/, replacements: ['a'], type: 'noun' },             // ≈æeny ‚Üí ≈æena
            { pattern: /√≠$/, replacements: ['e'], type: 'noun' },             // r≈Ø≈æ√≠ ‚Üí r≈Ø≈æe
            { pattern: /emi$/, replacements: ['e'], type: 'noun' },           // r≈Ø≈æemi ‚Üí r≈Ø≈æe
            
            // –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ - —Å—Ä–µ–¥–Ω–∏–π —Ä–æ–¥
            { pattern: /a$/, replacements: ['o'], type: 'noun' },             // mƒõsta ‚Üí mƒõsto
            { pattern: /y$/, replacements: ['o'], type: 'noun' },             // mƒõsty ‚Üí mƒõsto
          ];
        }
        
        // –£–õ–£–ß–®–ï–ù–ù–ê–Ø —Ñ—É–Ω–∫—Ü–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –í–°–ï –≤–∞—Ä–∏–∞–Ω—Ç—ã
        normalize(word) {
          if (!word || typeof word !== 'string') {
            return [word];
          }
          
          const originalWord = word;
          word = word.toLowerCase().trim();
          
          // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–æ–≤–∞—Ä—å –∏—Å–∫–ª—é—á–µ–Ω–∏–π
          if (this.exceptions[word]) {
            console.log(`–ò—Å–∫–ª—é—á–µ–Ω–∏–µ: ${originalWord} ‚Üí ${this.exceptions[word]}`);
            return [this.exceptions[word]];
          }
          
          // 2. –°–æ–±–∏—Ä–∞–µ–º –í–°–ï –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
          const candidates = new Set();
          candidates.add(word); // –ò—Å—Ö–æ–¥–Ω–æ–µ —Å–ª–æ–≤–æ –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–≤–æ–µ
          
          // –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—Å–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞
          for (const rule of this.normalizationRules) {
            if (rule.pattern.test(word)) {
              for (const replacement of rule.replacements) {
                const normalized = word.replace(rule.pattern, replacement);
                if (normalized !== word && normalized.length > 0) {
                  candidates.add(normalized);
                  console.log(`–ü—Ä–∞–≤–∏–ª–æ ${rule.type}: ${originalWord} ‚Üí ${normalized}`);
                }
              }
            }
          }
          
          // 3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã—Ö
          const candidatesArray = Array.from(candidates);
          for (const candidate of candidatesArray) {
            const nounForm = this.adjToNoun(candidate);
            if (nounForm && nounForm !== candidate) {
              candidates.add(nounForm);
              console.log(`–ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ ‚Üí —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ: ${candidate} ‚Üí ${nounForm}`);
            }
          }
          
          return Array.from(candidates);
        }
        
        // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–≥–æ –≤ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ
        adjToNoun(adjective) {
          const adjToNounMap = {
            'z√°kaznick√Ω': 'z√°kazn√≠k',
            'mƒõstsk√Ω': 'mƒõsto',
            '≈°koln√≠': '≈°kola',
            'rodinn√Ω': 'rodina',
            'st√°tn√≠': 'st√°t',
            'n√°rodn√≠': 'n√°rod',
            'evropsk√Ω': 'evropa',
            'ƒçesk√Ω': 'ƒçechy',
            'rusk√Ω': 'rusko',
            'americk√Ω': 'amerika',
            'finanƒçn√≠': 'finance',
            'technick√Ω': 'technika',
            'politick√Ω': 'politika',
            'ekonomick√Ω': 'ekonomie',
            'soci√°ln√≠': 'spoleƒçnost',
            'kulturn√≠': 'kultura',
            'sportovn√≠': 'sport',
            'obchodn√≠': 'obchod',
            'pr≈Ømyslov√Ω': 'pr≈Ømysl',
            'zemƒõdƒõlsk√Ω': 'zemƒõdƒõlstv√≠'
          };
          
          return adjToNounMap[adjective] || null;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
        test() {
          const testCases = [
            'doporuƒçujeme',  // –¥–æ–ª–∂–Ω–æ –¥–∞—Ç—å: doporuƒçovat –ò doporuƒçit
            'kladen√Ωch', 
            'z√°kaznickou',
            'dotaz≈Ø',
            'pros√≠me',
            'smƒõ≈ôujte'
          ];
          
          console.log('=== –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ ===');
          testCases.forEach(word => {
            const variants = this.normalize(word);
            console.log(`${word} ‚Üí [${variants.join(', ')}]`);
          });
        }
      }

      // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –ø–µ—Ä–µ–≤–æ–¥–∞
      window.czechNormalizer = new CzechNormalizer();

      // –£–õ–£–ß–®–ï–ù–ù–ê–Ø —Ñ—É–Ω–∫—Ü–∏—è fetchTranslation —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏
      window.fetchTranslationWithNormalization = async function(word) {
        if (!word) return null;
        
        console.log(`\n=== –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª–æ–≤–∞: "${word}" ===`);
        
        if (!window.translationsCache) {
          window.translationsCache = {};
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞
        if (window.translationsCache[word]) {
          console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –¥–ª—è "' + word + '"');
          return window.translationsCache[word];
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º Firebase –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞
        try {
          let cloudTranslation = await getFromCloudDictionary(word);
          if (cloudTranslation) {
            console.log('–ù–∞–π–¥–µ–Ω –ø–µ—Ä–µ–≤–æ–¥ –≤ –æ–±–ª–∞—á–Ω–æ–º —Å–ª–æ–≤–∞—Ä–µ –¥–ª—è "' + word + '"');
            window.translationsCache[word] = cloudTranslation;
            return cloudTranslation;
          }
        } catch (dbError) {
          console.warn('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–∑ Firebase:', dbError);
        }
        
        // –ü–æ–ª—É—á–∞–µ–º –í–°–ï –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
        const allVariants = window.czechNormalizer.normalize(word);
        console.log(`–í–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è "${word}":`, allVariants);
        
        // –ü—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –ø–µ—Ä–µ–≤–æ–¥ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞
        for (const wordToTry of allVariants) {
          try {
            console.log(`–ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞: "${wordToTry}"`);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
            if (window.translationsCache[wordToTry]) {
              console.log('–ù–∞–π–¥–µ–Ω –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –¥–ª—è "' + wordToTry + '"');
              const result = { ...window.translationsCache[wordToTry] };
              result.originalWord = word;
              result.normalizedWord = wordToTry;
              result.normalizedVariants = allVariants;
              window.translationsCache[word] = result;
              return result;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º Firebase
            try {
              let cloudTranslation = await getFromCloudDictionary(wordToTry);
              if (cloudTranslation) {
                console.log('–ù–∞–π–¥–µ–Ω –ø–µ—Ä–µ–≤–æ–¥ –≤ –æ–±–ª–∞—á–Ω–æ–º —Å–ª–æ–≤–∞—Ä–µ –¥–ª—è "' + wordToTry + '"');
                const result = { ...cloudTranslation };
                result.originalWord = word;
                result.normalizedWord = wordToTry;
                result.normalizedVariants = allVariants;
                window.translationsCache[word] = result;
                window.translationsCache[wordToTry] = result;
                return result;
              }
            } catch (dbError) {
              console.warn('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–∑ Firebase –¥–ª—è "' + wordToTry + '":', dbError);
            }
            
            // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ API
            const response = await fetch(`http://localhost:3001/api/translate?word=${encodeURIComponent(wordToTry)}&from=cs&to=ru`, {
              method: 'GET',
              headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
              },
              signal: AbortSignal.timeout ? AbortSignal.timeout(30000) : undefined
            });
            
            if (response.ok) {
              const data = await response.json();
              
              if (data.success && data.translations && 
                  (data.translations.translations && data.translations.translations.length > 0 || 
                   data.translations.samples && data.translations.samples.length > 0)) {
                
                console.log(`‚úÖ –ù–∞–π–¥–µ–Ω –ø–µ—Ä–µ–≤–æ–¥ –¥–ª—è "${wordToTry}"!`);
                
                const result = {
                  word: word,                                    // –ò—Å—Ö–æ–¥–Ω–æ–µ —Å–ª–æ–≤–æ
                  originalWord: word,
                  normalizedWord: wordToTry,                    // –°–ª–æ–≤–æ, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∞–π–¥–µ–Ω –ø–µ—Ä–µ–≤–æ–¥
                  normalizedVariants: allVariants,              // –í–°–ï –ø–æ–ø—Ä–æ–±–æ–≤–∞–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
                  usedNormalization: wordToTry !== word,        // –ë—ã–ª–∞ –ª–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
                  translations: data.translations.translations || [],
                  samples: data.translations.samples || [],
                  source: data.fromCache ? 'local_cache' : 'glosbe_live',
                  timestamp: new Date().toISOString()
                };
                
                // –ö—ç—à–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                window.translationsCache[word] = result;
                window.translationsCache[wordToTry] = result;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Firebase
                try {
                  await saveToCloudDictionary(result);
                } catch (saveError) {
                  console.warn('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ Firebase:', saveError);
                }
                
                return result;
              }
            }
            
            console.log(`‚ùå –ü–µ—Ä–µ–≤–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è "${wordToTry}"`);
            
          } catch (error) {
            console.warn(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–µ—Ä–µ–≤–æ–¥–∞ "${wordToTry}":`, error);
          }
        }
        
        // –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –ø—Ä–æ–±—É–µ–º –±–∞–∑–æ–≤—ã–π —Å–ª–æ–≤–∞—Ä—å
        console.log('–ü—Ä–æ–±—É–µ–º –±–∞–∑–æ–≤—ã–π —Å–ª–æ–≤–∞—Ä—å...');
        for (const variant of allVariants) {
          const basicTranslations = getBasicTranslation(variant);
          if (basicTranslations) {
            const fallbackResult = {
              word: word,
              originalWord: word,
              normalizedWord: variant,
              normalizedVariants: allVariants,
              translations: basicTranslations,
              samples: [],
              source: 'basic_dict',
              note: '–ë–∞–∑–æ–≤—ã–π –ø–µ—Ä–µ–≤–æ–¥ (Glosbe –Ω–µ –¥–∞–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)',
              timestamp: new Date().toISOString()
            };
            
            window.translationsCache[word] = fallbackResult;
            return fallbackResult;
          }
        }
        
        // –ü–æ–ª–Ω—ã–π fallback
        return {
          word: word,
          originalWord: word,
          normalizedWord: allVariants[1] || word,
          normalizedVariants: allVariants,
          translations: [],
          samples: [],
          note: "–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –ø–µ—Ä–µ–≤–æ–¥ –Ω–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞: " + allVariants.join(', '),
          timestamp: new Date().toISOString()
        };
      };

      console.log('‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —á–µ—à—Å–∫–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!');
    </script>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <script>
      // –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (ES5 –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
      const { useState, useEffect, createElement: h } = React;

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞
      const extractUniqueWords = function(text) {
        if (!text || typeof text !== 'string') {
          return [];
        }

        const lowerCaseText = text.toLowerCase();
        const cleanedText = lowerCaseText.replace(/[.,/#!$%^&*;:{}=\-_`~()¬´¬ª‚Äû"[\]]/g, ' ');
        const words = cleanedText
          .split(/\s+/)
          .filter(function(word) { return word.length > 1; });
        
        const uniqueWordsSet = new Set(words);
        return Array.from(uniqueWordsSet).sort();
      };
      
      // –ó–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—É—é —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞ –Ω–æ–≤—É—é —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π
      window.fetchTranslation = window.fetchTranslationWithNormalization;

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞ –≤ Firebase
      async function saveToCloudDictionary(wordData) {
        if (!window.firebaseDB) {
          console.warn('Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–æ');
          return false;
        }
        
        try {
          const wordKey = wordData.word.toLowerCase();
          const database = window.firebaseDB;
          const dbRef = window.firebaseRef;
          const dbSet = window.firebaseSet;
          const dbGet = window.firebaseGet;
          
          try {
            const snapshot = await dbGet(dbRef(database, 'dictionary/' + wordKey));
            
            if (snapshot.exists()) {
              const existingData = snapshot.val();
              
              const allTranslations = Array.from(new Set([].concat(
                existingData.translations || [],
                wordData.translations || []
              )));
              
              const samplesMap = {};
              
              (existingData.samples || []).forEach(function(sample) {
                const key = sample.phrase + '|' + sample.translation;
                samplesMap[key] = sample;
              });
              
              (wordData.samples || []).forEach(function(sample) {
                const key = sample.phrase + '|' + sample.translation;
                samplesMap[key] = sample;
              });
              
              const allSamples = Object.values(samplesMap);
              
              const updatedData = Object.assign({}, existingData, {
                translations: allTranslations,
                samples: allSamples,
                lastUpdated: new Date().toISOString()
              });
              
              await dbSet(dbRef(database, 'dictionary/' + wordKey), updatedData);
            } else {
              await dbSet(dbRef(database, 'dictionary/' + wordKey), Object.assign({}, wordData, {
                created: new Date().toISOString(),
                lastUpdated: new Date().toISOString()
              }));
            }
          } catch (getError) {
            await dbSet(dbRef(database, 'dictionary/' + wordKey), Object.assign({}, wordData, {
              created: new Date().toISOString(),
              lastUpdated: new Date().toISOString()
            }));
          }
          
          console.log('–°–ª–æ–≤–æ "' + wordData.word + '" —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –æ–±–ª–∞—á–Ω–æ–º —Å–ª–æ–≤–∞—Ä–µ');
          return true;
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ –æ–±–ª–∞—á–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å:', error);
          return false;
        }
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞ –∏–∑ Firebase
      async function getFromCloudDictionary(word) {
        if (!word || !window.firebaseDB) return null;
        
        try {
          const wordKey = word.toLowerCase();
          const database = window.firebaseDB;
          const dbRef = window.firebaseRef;
          const dbGet = window.firebaseGet;
          
          const snapshot = await dbGet(dbRef(database, 'dictionary/' + wordKey));
          
          if (snapshot.exists()) {
            console.log('–°–ª–æ–≤–æ "' + word + '" –Ω–∞–π–¥–µ–Ω–æ –≤ –æ–±–ª–∞—á–Ω–æ–º —Å–ª–æ–≤–∞—Ä–µ');
            return snapshot.val();
          } else {
            console.log('–°–ª–æ–≤–æ "' + word + '" –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –æ–±–ª–∞—á–Ω–æ–º —Å–ª–æ–≤–∞—Ä–µ');
            return null;
          }
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–∑ –æ–±–ª–∞—á–Ω–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è:', error);
          return null;
        }
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ–≥–æ —Å–ª–æ–≤–∞—Ä—è
      async function getEntireDictionary() {
        if (!window.firebaseDB) {
          console.warn('Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
          return [];
        }
        
        try {
          const database = window.firebaseDB;
          const dbRef = window.firebaseRef;
          const dbGet = window.firebaseGet;
          
          const snapshot = await dbGet(dbRef(database, 'dictionary'));
          
          if (snapshot.exists()) {
            const dictionary = snapshot.val();
            return Object.values(dictionary);
          } else {
            console.log('–°–ª–æ–≤–∞—Ä—å –ø—É—Å—Ç');
            return [];
          }
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–ª–æ–≤–∞—Ä—è:', error);
          return [];
        }
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å–ª–æ–≤–∞—Ä—è –≤ JSON
      function exportDictionaryToJson(dictionary) {
        try {
          const dataStr = JSON.stringify(dictionary, null, 2);
          const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
          
          const exportFileDefaultName = 'czech_dictionary.json';
          
          const linkElement = document.createElement('a');
          linkElement.setAttribute('href', dataUri);
          linkElement.setAttribute('download', exportFileDefaultName);
          linkElement.click();
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ —Å–ª–æ–≤–∞—Ä—è:', error);
          alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ —Å–ª–æ–≤–∞—Ä—è: ' + error.message);
        }
      }
      
      // –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –±–∞–∑–æ–≤—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è fallback
      function getBasicTranslation(word) {
        const basicDict = {
          // –ü—Ä–µ–¥–ª–æ–≥–∏ –∏ —á–∞—Å—Ç–∏—Ü—ã
          'do': ['–≤', '–∫', '–¥–æ'],
          'na': ['–Ω–∞', '–≤'], 
          'za': ['–∑–∞', '–≤ —Ç–µ—á–µ–Ω–∏–µ'],
          'se': ['—Å–µ–±—è', '-—Å—è'],
          'ze': ['–∏–∑', '–æ—Ç'],
          'po': ['–ø–æ', '–ø–æ—Å–ª–µ'],
          'od': ['–æ—Ç', '—Å'],
          'pro': ['–¥–ª—è', '–∑–∞'],
          'p≈ôi': ['–ø—Ä–∏', '–≤–æ –≤—Ä–µ–º—è'],
          'bez': ['–±–µ–∑'],
          'podle': ['—Å–æ–≥–ª–∞—Å–Ω–æ', '–ø–æ'],
          'bƒõhem': ['–≤ —Ç–µ—á–µ–Ω–∏–µ', '–≤–æ –≤—Ä–µ–º—è'],
          'm√≠sto': ['–º–µ—Å—Ç–æ', '–≤–º–µ—Å—Ç–æ'],
          'kolem': ['–æ–∫–æ–ª–æ', '–≤–æ–∫—Ä—É–≥'],
          'mezi': ['–º–µ–∂–¥—É'],
          'p≈ôed': ['–ø–µ—Ä–µ–¥', '–¥–æ'],
          'nad': ['–Ω–∞–¥'],
          'pod': ['–ø–æ–¥'],
          'vedle': ['—Ä—è–¥–æ–º', '–æ–∫–æ–ª–æ'],
          
          // –ì–ª–∞–≥–æ–ª—ã
          'doporuƒçujeme': ['—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º'],
          'doporuƒçuje': ['—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç'],
          'doporuƒçovat': ['—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å', '—Å–æ–≤–µ—Ç–æ–≤–∞—Ç—å'],
          'doporuƒçit': ['–ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å', '–ø–æ—Å–æ–≤–µ—Ç–æ–≤–∞—Ç—å'],
          'm≈Ø≈æete': ['–º–æ–∂–µ—Ç–µ'],
          'm≈Ø≈æeme': ['–º–æ–∂–µ–º'],
          'chcete': ['—Ö–æ—Ç–∏—Ç–µ'],
          'chceme': ['—Ö–æ—Ç–∏–º'],
          'pot≈ôebujete': ['–Ω—É–∂–¥–∞–µ—Ç–µ—Å—å'],
          'pot≈ôebujeme': ['–Ω—É–∂–¥–∞–µ–º—Å—è'],
          'je': ['–µ—Å—Ç—å', '—è–≤–ª—è–µ—Ç—Å—è'],
          'jsou': ['—è–≤–ª—è—é—Ç—Å—è', '–µ—Å—Ç—å'],
          'm√≠t': ['–∏–º–µ—Ç—å'],
          'b√Ωt': ['–±—ã—Ç—å'],
          'dƒõlat': ['–¥–µ–ª–∞—Ç—å'],
          'j√≠t': ['–∏–¥—Ç–∏'],
          '≈ô√≠ct': ['—Å–∫–∞–∑–∞—Ç—å'],
          'vƒõdƒõt': ['–∑–Ω–∞—Ç—å'],
          'vidƒõt': ['–≤–∏–¥–µ—Ç—å'],
          'd√°t': ['–¥–∞—Ç—å'],
          'p≈ôij√≠t': ['–ø—Ä–∏–π—Ç–∏'],
          'kl√°st': ['–∫–ª–∞—Å—Ç—å'],
          'prosit': ['–ø—Ä–æ—Å–∏—Ç—å'],
          'smƒõ≈ôovat': ['–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å'],
          
          // –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ
          'televize': ['—Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ', '—Ç–µ–ª–µ–≤–∏–∑–æ—Ä', '–¢–í'],
          'd≈Øm': ['–¥–æ–º'],
          'auto': ['–∞–≤—Ç–æ–º–æ–±–∏–ª—å', '–º–∞—à–∏–Ω–∞'],
          'kino': ['–∫–∏–Ω–æ', '–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä'],
          '≈°kola': ['—à–∫–æ–ª–∞'],
          'pr√°ce': ['—Ä–∞–±–æ—Ç–∞'],
          'j√≠dlo': ['–µ–¥–∞', '–ø–∏—â–∞'],
          'voda': ['–≤–æ–¥–∞'],
          'ƒças': ['–≤—Ä–µ–º—è'],
          'den': ['–¥–µ–Ω—å'],
          'noc': ['–Ω–æ—á—å'],
          'r√°no': ['—É—Ç—Ä–æ'],
          'veƒçer': ['–≤–µ—á–µ—Ä'],
          'rok': ['–≥–æ–¥'],
          'mƒõs√≠c': ['–º–µ—Å—è—Ü'],
          't√Ωden': ['–Ω–µ–¥–µ–ª—è'],
          'ƒçlovƒõk': ['—á–µ–ª–æ–≤–µ–∫'],
          '≈æena': ['–∂–µ–Ω—â–∏–Ω–∞'],
          'mu≈æ': ['–º—É–∂—á–∏–Ω–∞'],
          'd√≠tƒõ': ['—Ä–µ–±–µ–Ω–æ–∫'],
          'rodina': ['—Å–µ–º—å—è'],
          'p≈ô√≠tel': ['–¥—Ä—É–≥'],
          'kniha': ['–∫–Ω–∏–≥–∞'],
          'film': ['—Ñ–∏–ª—å–º'],
          'hudba': ['–º—É–∑—ã–∫–∞'],
          'telefon': ['—Ç–µ–ª–µ—Ñ–æ–Ω'],
          'poƒç√≠taƒç': ['–∫–æ–º–ø—å—é—Ç–µ—Ä'],
          'internet': ['–∏–Ω—Ç–µ—Ä–Ω–µ—Ç'],
          'pen√≠ze': ['–¥–µ–Ω—å–≥–∏'],
          'obchod': ['–º–∞–≥–∞–∑–∏–Ω'],
          'restaurace': ['—Ä–µ—Å—Ç–æ—Ä–∞–Ω'],
          'hotel': ['–æ—Ç–µ–ª—å'],
          'mƒõsto': ['–≥–æ—Ä–æ–¥'],
          'zemƒõ': ['—Å—Ç—Ä–∞–Ω–∞'],
          'svƒõt': ['–º–∏—Ä'],
          'dotaz': ['–≤–æ–ø—Ä–æ—Å'],
          'z√°kazn√≠k': ['–∫–ª–∏–µ–Ω—Ç'],
          'podpora': ['–ø–æ–¥–¥–µ—Ä–∂–∫–∞'],
          'slu≈æba': ['—É—Å–ª—É–≥–∞'],
          'probl√©m': ['–ø—Ä–æ–±–ª–µ–º–∞'],
          'n√°vrh': ['–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ'],
          'zlep≈°en√≠': ['—É–ª—É—á—à–µ–Ω–∏–µ'],
          'p≈ôipom√≠nka': ['–∑–∞–º–µ—á–∞–Ω–∏–µ'],
          
          // –ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ
          'dobr√Ω': ['—Ö–æ—Ä–æ—à–∏–π'],
          '≈°patn√Ω': ['–ø–ª–æ—Ö–æ–π'],
          'velk√Ω': ['–±–æ–ª—å—à–æ–π'],
          'mal√Ω': ['–º–∞–ª–µ–Ω—å–∫–∏–π'],
          'nov√Ω': ['–Ω–æ–≤—ã–π'],
          'star√Ω': ['—Å—Ç–∞—Ä—ã–π'],
          'kr√°sn√Ω': ['–∫—Ä–∞—Å–∏–≤—ã–π'],
          'mlad√Ω': ['–º–æ–ª–æ–¥–æ–π'],
          'd≈Øle≈æit√Ω': ['–≤–∞–∂–Ω—ã–π'],
          'zaj√≠mav√Ω': ['–∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π'],
          'tƒõ≈æk√Ω': ['—Ç—è–∂–µ–ª—ã–π', '—Ç—Ä—É–¥–Ω—ã–π'],
          'lehk√Ω': ['–ª–µ–≥–∫–∏–π'],
          'rychl√Ω': ['–±—ã—Å—Ç—Ä—ã–π'],
          'pomal√Ω': ['–º–µ–¥–ª–µ–Ω–Ω—ã–π'],
          'lep≈°√≠': ['–ª—É—á—à–∏–π'],
          'z√°kaznick√Ω': ['–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π'],
          
          // –ù–∞—Ä–µ—á–∏—è
          'tak√©': ['—Ç–∞–∫–∂–µ'],
          'ƒçasto': ['—á–∞—Å—Ç–æ'],
          'nebo': ['–∏–ª–∏'],
          'jak√©koli': ['–ª—é–±—ã–µ']
        };
        
        return basicDict[word.toLowerCase()] || null;
      }
      
      // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–ª–æ–≤–∞—Ä—è
      const DictionaryStats = function(props) {
        const onViewDictionary = props.onViewDictionary;
        const wordCountState = useState(0);
        const wordCount = wordCountState[0];
        const setWordCount = wordCountState[1];
        
        useEffect(function() {
          async function loadStats() {
            try {
              const dictionary = await getEntireDictionary();
              setWordCount(dictionary.length);
            } catch (error) {
              console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–ª–æ–≤–∞—Ä—è:', error);
            }
          }
          
          loadStats();
        }, []);
        
        const handleExportDictionary = async function() {
          try {
            const dictionary = await getEntireDictionary();
            if (dictionary.length > 0) {
              exportDictionaryToJson(dictionary);
            } else {
              alert('–°–ª–æ–≤–∞—Ä—å –ø—É—Å—Ç. –ù–µ—á–µ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å.');
            }
          } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ —Å–ª–æ–≤–∞—Ä—è:', error);
            alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ —Å–ª–æ–≤–∞—Ä—è.');
          }
        };
        
        return h('div', { className: 'dictionary-stats' },
          h('p', null, '–í –≤–∞—à–µ–º –æ–±–ª–∞—á–Ω–æ–º —Å–ª–æ–≤–∞—Ä–µ: ', h('strong', null, wordCount), ' —Å–ª–æ–≤'),
          h('div', { style: { marginTop: '10px' } },
            h('button', { className: 'dictionary-button', onClick: onViewDictionary }, '–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ª–æ–≤–∞—Ä—å'),
            h('button', { className: 'dictionary-button', onClick: handleExportDictionary }, '–≠–∫—Å–ø–æ—Ä—Ç —Å–ª–æ–≤–∞—Ä—è')
          )
        );
      };

      // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ª–æ–≤–∞—Ä—è
      const DictionaryViewer = function(props) {
        const onClose = props.onClose;
        const dictionaryState = useState([]);
        const dictionary = dictionaryState[0];
        const setDictionary = dictionaryState[1];
        const isLoadingState = useState(true);
        const isLoading = isLoadingState[0];
        const setIsLoading = isLoadingState[1];
        
        useEffect(function() {
          async function loadDictionary() {
            setIsLoading(true);
            try {
              const dict = await getEntireDictionary();
              dict.sort(function(a, b) { return a.word.localeCompare(b.word); });
              setDictionary(dict);
            } catch (error) {
              console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–ª–æ–≤–∞—Ä—è:', error);
            } finally {
              setIsLoading(false);
            }
          }
          
          loadDictionary();
        }, []);
        
        if (isLoading) {
          return h('div', { className: 'dictionary-view' }, '–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ª–æ–≤–∞—Ä—è...');
        }
        
        if (dictionary.length === 0) {
          return h('div', { className: 'dictionary-view' },
            h('p', null, '–°–ª–æ–≤–∞—Ä—å –ø—É—Å—Ç. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–æ–≤–∞, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞.'),
            h('button', { className: 'btn btn-secondary', onClick: onClose, style: { marginTop: '15px' } }, '–ó–∞–∫—Ä—ã—Ç—å')
          );
        }
        
        return h('div', null,
          h('div', { className: 'dictionary-view' },
            dictionary.map(function(entry, index) {
              return h('div', { key: index, className: 'dict-word-item' },
                h('div', { className: 'dict-word' }, entry.word),
                h('div', { className: 'dict-translations' }, entry.translations.join(', '))
              );
            })
          ),
          h('button', { className: 'btn btn-secondary', onClick: onClose, style: { marginTop: '15px' } }, '–ó–∞–∫—Ä—ã—Ç—å')
        );
      };
      
      // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞
      const TextInput = function(props) {
        const text = props.text;
        const onTextChange = props.onTextChange;
        const onExtractWords = props.onExtractWords;
        
        return h('div', { className: 'text-input' },
          h('h2', null, '–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –Ω–∞ —á–µ—à—Å–∫–æ–º —è–∑—ã–∫–µ'),
          h('p', { className: 'instruction' }, 
            '–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç (—Å—Ç–∞—Ç—å—é, —Ä–∞—Å—Å–∫–∞–∑, –¥–∏–∞–ª–æ–≥) –Ω–∞ —á–µ—à—Å–∫–æ–º —è–∑—ã–∫–µ, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω—É–∂–Ω–æ –∏–∑–≤–ª–µ—á—å —Å–ª–æ–≤–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è.'
          ),
          h('textarea', {
            className: 'text-area',
            value: text,
            onChange: function(e) { onTextChange(e.target.value); },
            placeholder: '–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –Ω–∞ —á–µ—à—Å–∫–æ–º —è–∑—ã–∫–µ...',
            rows: 10
          }),
          h('button', {
            className: 'btn btn-primary',
            onClick: onExtractWords,
            disabled: !text.trim()
          }, '–ò–∑–≤–ª–µ—á—å —Å–ª–æ–≤–∞')
        );
      };

      // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
      const ProgressIndicator = function(props) {
        const progress = props.progress;
        
        return h('div', { className: 'progress-container' },
          h('div', { className: 'progress-bar' },
            h('div', { 
              className: 'progress-bar-fill',
              style: { width: progress + '%' }
            })
          ),
          h('div', { className: 'progress-text' }, progress + '% –∑–∞–≤–µ—Ä—à–µ–Ω–æ')
        );
      };

      // –£–õ–£–ß–®–ï–ù–ù–´–ô –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –ø–æ–∫–∞–∑–æ–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
      const Flashcard = function(props) {
        const word = props.word;
        const translations = props.translations;
        const samples = props.samples;
        const note = props.note;
        const normalizedWord = props.normalizedWord;           // –ù–û–í–û–ï!
        const normalizedVariants = props.normalizedVariants;   // –ù–û–í–û–ï!
        
        const isFlippedState = useState(false);
        const isFlipped = isFlippedState[0];
        const setIsFlipped = isFlippedState[1];
        
        const handleFlip = function() {
          setIsFlipped(!isFlipped);
        };
        
        return h('div', {
          className: 'flashcard' + (isFlipped ? ' flipped' : ''),
          onClick: handleFlip
        },
          h('div', { className: 'card-inner' },
            h('div', { className: 'card-front' },
              h('div', { className: 'word' }, word),
              // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –Ω–∞ –ª–∏—Ü–µ–≤–æ–π —Å—Ç–æ—Ä–æ–Ω–µ, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
              normalizedWord && normalizedWord !== word &&h('div', { 
                className: 'normalization-hint',
                style: { 
                  fontSize: '0.8rem', 
                  opacity: '0.8', 
                  marginTop: '10px',
                  fontStyle: 'italic',
                  color: '#f0f0f0'
                }
              }, '‚Üí ' + normalizedWord),
              h('p', { className: 'hint' }, '–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–µ—Ä–µ–≤–æ–¥')
            ),
            h('div', { className: 'card-back' },
              h('h3', { className: 'original-word' }, word),
              
              // –ù–û–í–´–ô –ë–õ–û–ö: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
              normalizedWord && normalizedWord !== word && h('div', { 
                className: 'normalization-info',
                style: {
                  backgroundColor: '#e3f2fd',
                  padding: '8px 12px',
                  borderRadius: '6px',
                  marginBottom: '15px',
                  border: '1px solid #bbdefb',
                  width: '100%'
                }
              },
                h('div', { 
                  style: { 
                    fontSize: '0.85rem', 
                    color: '#1565c0',
                    fontWeight: '500',
                    marginBottom: '4px'
                  }
                }, 'üîÑ –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ:'),
                h('div', { 
                  style: { 
                    fontSize: '0.9rem', 
                    color: '#0d47a1',
                    fontWeight: '600'
                  }
                }, normalizedWord),
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ
                normalizedVariants && normalizedVariants.length > 2 && h('div', {
                  style: {
                    fontSize: '0.75rem',
                    color: '#666',
                    marginTop: '4px'
                  }
                }, '–í–∞—Ä–∏–∞–Ω—Ç—ã: ' + normalizedVariants.slice(1).join(', '))
              ),
              
              h('div', { className: 'translations' },
                translations && translations.length > 0 ? 
                  h('div', null,
                    h('h4', null, '–ü–µ—Ä–µ–≤–æ–¥—ã:'),
                    h('ul', null,
                      translations.map(function(translation, index) {
                        return h('li', { key: index }, translation);
                      })
                    )
                  ) :
                  h('p', { className: 'no-translations' }, '–ü–µ—Ä–µ–≤–æ–¥—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã')
              ),
              
              samples && samples.length > 0 && h('div', { className: 'examples' },
                h('h4', null, '–ü—Ä–∏–º–µ—Ä—ã' + (normalizedWord && normalizedWord !== word ? ' (' + normalizedWord + '):' : ':')),
                h('ul', null,
                  samples.map(function(sample, index) {
                    return h('li', { key: index },
                      h('div', { className: 'sample-phrase' }, sample.phrase),
                      h('div', { className: 'sample-translation' }, sample.translation)
                    );
                  })
                )
              ),
              
              note && h('p', { className: 'note' }, note),
              
              h('p', { className: 'hint' }, '–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ª–æ–≤—É'),
              
              h('div', { className: 'attribution' }, 
                '–ò—Å—Ç–æ—á–Ω–∏–∫: Glosbe' + 
                (normalizedWord && normalizedWord !== word ? ' (—á–µ—Ä–µ–∑ ' + normalizedWord + ')' : '')
              )
            )
          )
        );
      };

      // –û–ë–ù–û–í–õ–ï–ù–ù–´–ô –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ —Å –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–∞–Ω–Ω—ã—Ö –æ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
      const FlashcardViewer = function(props) {
        const flashcards = props.flashcards;
        const currentIndexState = useState(0);
        const currentIndex = currentIndexState[0];
        const setCurrentIndex = currentIndexState[1];
        
        if (!flashcards || flashcards.length === 0) {
          return h('div', { className: 'no-cards' }, '–ö–∞—Ä—Ç–æ—á–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
        }
        
        const currentCard = flashcards[currentIndex];
        
        const goToPrevious = function() {
          setCurrentIndex(function(prevIndex) {
            return prevIndex === 0 ? flashcards.length - 1 : prevIndex - 1;
          });
        };
        
        const goToNext = function() {
          setCurrentIndex(function(prevIndex) {
            return prevIndex === flashcards.length - 1 ? 0 : prevIndex + 1;
          });
        };
        
        return h('div', { className: 'flashcard-viewer' },
          h('div', { className: 'progress-info' },
            '–ö–∞—Ä—Ç–æ—á–∫–∞ ' + (currentIndex + 1) + ' –∏–∑ ' + flashcards.length
          ),
          h('div', { className: 'card-container' },
            h('button', {
              className: 'nav-btn prev-btn',
              onClick: goToPrevious,
              'aria-label': '–ü—Ä–µ–¥—ã–¥—É—â–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞'
            }, '<'),
            
            // ‚úÖ –û–ë–ù–û–í–õ–ï–ù–ò–ï: –ü–µ—Ä–µ–¥–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
            h(Flashcard, {
              word: currentCard.word,
              translations: currentCard.translations,
              samples: currentCard.samples,
              note: currentCard.note,
              normalizedWord: currentCard.normalizedWord,           // ‚Üê –ù–û–í–û–ï!
              normalizedVariants: currentCard.normalizedVariants   // ‚Üê –ù–û–í–û–ï!
            }),
            
            h('button', {
              className: 'nav-btn next-btn',
              onClick: goToNext,
              'aria-label': '–°–ª–µ–¥—É—é—â–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞'
            }, '>')
          ),
          h('div', { className: 'card-progress' },
            flashcards.map(function(_, index) {
              return h('span', {
                key: index,
                className: 'progress-dot' + (index === currentIndex ? ' active' : ''),
                onClick: function() { setCurrentIndex(index); }
              });
            })
          )
        );
      };

      // –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
      const App = function() {
        const textState = useState('');
        const text = textState[0];
        const setText = textState[1];
        
        const uniqueWordsState = useState([]);
        const uniqueWords = uniqueWordsState[0];
        const setUniqueWords = uniqueWordsState[1];
        
        const flashcardsState = useState([]);
        const flashcards = flashcardsState[0];
        const setFlashcards = flashcardsState[1];
        
        const isLoadingState = useState(false);
        const isLoading = isLoadingState[0];
        const setIsLoading = isLoadingState[1];
        
        const currentStepState = useState('input');
        const currentStep = currentStepState[0];
        const setCurrentStep = currentStepState[1];
        
        const progressState = useState(0);
        const progress = progressState[0];
        const setProgress = progressState[1];
        
        const errorState = useState('');
        const error = errorState[0];
        const setError = errorState[1];

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
        const handleTextChange = function(newText) {
          setText(newText);
        };

        // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞
        const handleExtractWords = function() {
          if (!text.trim()) return;
          
          const words = extractUniqueWords(text);
          setUniqueWords(words);
          setCurrentStep('extracted');
          setError('');
        };

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –¥–ª—è –≤—Å–µ—Ö –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤
        const handleGetTranslations = async function() {
          if (uniqueWords.length === 0) return;
          
          setIsLoading(true);
          setProgress(0);
          setError('');
          
          try {
            const translatedCards = [];
            let completed = 0;
            const total = uniqueWords.length;
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø–æ 2 —Å–ª–æ–≤–∞ –∑–∞ —Ä–∞–∑, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —Å–µ—Ä–≤–µ—Ä
            for (let i = 0; i < uniqueWords.length; i += 2) {
              const batch = uniqueWords.slice(i, i + 2);
              const batchPromises = batch.map(function(word) { 
                return window.fetchTranslation(word); 
              });
              
              try {
                const batchResults = await Promise.all(batchPromises);
                
                batchResults.forEach(function(result) {
                  if (result) {
                    translatedCards.push(result);
                  }
                });
              } catch (batchError) {
                console.error('Error processing batch:', batchError);
                // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –¥–∞–∂–µ –µ—Å–ª–∏ —á–∞—Å—Ç—å —Å–ª–æ–≤ –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–≤–µ—Å—Ç–∏
              }
              
              // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
              completed += batch.length;
              setProgress(Math.floor((completed / total) * 100));
              
              // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —Å–µ—Ä–≤–µ—Ä
              if (i + 2 < uniqueWords.length) {
                await new Promise(function(resolve) { 
                  setTimeout(resolve, 3000); 
                });
              }
            }
            
            if (translatedCards.length === 0) {
              setError('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
            } else {
              setFlashcards(translatedCards);
              setCurrentStep('translated');
            }
          } catch (error) {
            console.error('Error fetching translations:', error);
            setError('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
          } finally {
            setIsLoading(false);
            setProgress(100);
          }
        };

        // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const handleReset = function() {
          setText('');
          setUniqueWords([]);
          setFlashcards([]);
          setCurrentStep('input');
          setProgress(0);
          setError('');
        };
        
        // –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ª–æ–≤–∞—Ä—è
        const handleViewDictionary = function() {
          setCurrentStep('dictionary');
        };
        
        // –í–æ–∑–≤—Ä–∞—Ç –∏–∑ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ª–æ–≤–∞—Ä—è
        const handleCloseDictionary = function() {
          setCurrentStep('input');
        };

        return h('div', { className: 'app' },
          h('header', { className: 'header' },
            h('h1', null, 'Flashcards Seznam'),
            h('p', { className: 'subtitle' }, '–ò–∑—É—á–µ–Ω–∏–µ —á–µ—à—Å–∫–∏—Ö —Å–ª–æ–≤ —Å –ø–æ–º–æ—â—å—é –∫–∞—Ä—Ç–æ—á–µ–∫')
          ),
          h('main', { className: 'main-content' },
            currentStep === 'input' && h(React.Fragment, null,
              h(TextInput, {
                text: text,
                onTextChange: handleTextChange,
                onExtractWords: handleExtractWords
              }),
              h(DictionaryStats, { onViewDictionary: handleViewDictionary })
            ),
            currentStep === 'extracted' && h('div', { className: 'extracted-words' },
              h('h2', null, '–ù–∞–π–¥–µ–Ω–æ ' + uniqueWords.length + ' —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤'),
              h('div', { className: 'words-container' },
                uniqueWords.map(function(word, index) {
                  return h('span', { key: index, className: 'word-chip' }, word);
                })
              ),
              h('div', { className: 'actions' },
                h('button', {
                  className: 'btn btn-primary',
                  onClick: handleGetTranslations,
                  disabled: isLoading
                }, isLoading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : '–ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã'),
                h('button', { className: 'btn btn-secondary', onClick: handleReset }, '–°–±—Ä–æ—Å–∏—Ç—å')
              ),
              isLoading && h(ProgressIndicator, { progress: progress }),
              error && h('div', { className: 'error-message' }, error)
            ),
            currentStep === 'translated' && h('div', null,
              h(FlashcardViewer, { flashcards: flashcards }),
              h('div', { className: 'actions' },
                h('button', { className: 'btn btn-secondary', onClick: handleReset }, '–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ'),
                h('button', { className: 'btn btn-primary', onClick: handleViewDictionary }, '–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ª–æ–≤–∞—Ä—å')
              ),
              h('div', { className: 'api-attribution' },
                '–ü–µ—Ä–µ–≤–æ–¥—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Å–ª–æ–≤–∞—Ä–µ–º ',
                h('a', { href: 'https://glosbe.com', target: '_blank', rel: 'noopener noreferrer' }, 'Glosbe')
              )
            ),
            currentStep === 'dictionary' && h(DictionaryViewer, { onClose: handleCloseDictionary })
          )
        );
      };

      // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
          const root = ReactDOM.createRoot(document.getElementById('root'));
          root.render(h(App));
        });
      } else {
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(h(App));
      }
      
      // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      setTimeout(function() {
        if (window.czechNormalizer) {
          window.czechNormalizer.test();
        }
      }, 1000);
    </script>
  </body>
</html>